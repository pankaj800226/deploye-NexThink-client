import{c as $,j as e,r as n,p as E,F as _,A as T,o as m,B as z,z as o}from"./index-BxPa0GNL.js";import{a as u,b as p}from"./api-DUhR3JNR.js";import{A as B}from"./ApiError-DejuQA7b.js";import{D as C}from"./Delete-_SXILsms.js";const I=$(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}));function H(){const[y,i]=n.useState([]),[x,f]=n.useState(""),l=localStorage.getItem("TOKEN"),[b,g]=n.useState(!1),[k,j]=n.useState(""),[A,S]=n.useState(!1);n.useEffect(()=>{(async()=>{try{g(!0);const t=await u.get(`${p}/api/shedular/get/shedular`,{headers:{Authorization:`Bearer ${l}`}});i(t.data.schedulers)}catch(t){console.log(t),j("API fetch error")}finally{g(!1)}})()},[l]);const w=(a,t)=>{const r=Array.from({length:7}).map((d,c)=>{const s=new Date(a);return s.setDate(s.getDate()+c),{checked:!1,date:s.toISOString()}});return{weekNo:t,days:r}},D=async()=>{if(!x.trim())return;const a={title:x.trim(),weeks:[w(new Date,1)]};try{const t=await u.post(`${p}/api/shedular/create/shedular`,a,{headers:{Authorization:`Bearer ${l}`}});o.success("Scheduler submitted"),i(r=>[...r,t.data.task]),f("")}catch(t){console.log(t),o.error("Error creating task"),j("API fetch error")}finally{S(!1)}},v=async(a,t,r,d)=>{try{const c=await u.put(`${p}/api/shedular/check`,{taskId:a,weekNo:t,dayIndex:r,checked:d},{headers:{Authorization:`Bearer ${l}`}});i(s=>s.map(h=>h._id===a?c.data.task:h))}catch{o.error("Failed to update"),j("API fetch error")}},N=async a=>{try{await u.delete(`${p}/api/shedular/delete/shedular/${a}`),i(t=>t.filter(r=>r._id!==a)),o.success("Sheduler Deleted")}catch(t){console.log(t),o.error("error")}};return k?e.jsx(B,{error:k}):b?e.jsx(E,{}):e.jsxs("div",{className:"habit-wrapper",children:[e.jsxs("div",{className:"habit-input",children:[e.jsx("input",{placeholder:"Enter Daily Task",value:x,onChange:a=>f(a.target.value)}),e.jsx("button",{onClick:D,children:A?e.jsx(_,{}):e.jsx(I,{})})]}),e.jsx(T,{children:y.length===0?e.jsx(m.h2,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},children:"Scheduler Not Yet"},"no-task"):y.map(a=>e.jsxs(m.div,{className:"task-box",initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},transition:{duration:.3},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h2",{children:a.title}),e.jsx(z,{onClick:()=>N(a._id),children:e.jsx(C,{sx:{color:"red"}})})]}),e.jsxs("table",{className:"habit-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Week / Month"}),Array.from({length:7}).map((t,r)=>e.jsxs("th",{children:["Day ",r+1]},r))]})}),e.jsx("tbody",{children:a.weeks.map((t,r)=>{const d=new Date(t.days[0].date).toLocaleString("default",{month:"long"});return e.jsxs("tr",{children:[e.jsxs("td",{children:["Week ",t.weekNo," ",e.jsx("br",{}),e.jsx("span",{children:d})]}),t.days.map((c,s)=>e.jsxs("td",{children:[e.jsxs("label",{className:`check-label ${c.checked?"checked":""}`,children:[e.jsx(m.input,{type:"checkbox",checked:c.checked,onChange:h=>v(a._id,t.weekNo,s,h.target.checked),whileTap:{scale:1.2}}),e.jsx("span",{})]}),e.jsx("div",{className:"date-label",children:new Date(c.date).getDate()})]},s))]},r)})})]})]},a._id))})]})}export{H as default};
